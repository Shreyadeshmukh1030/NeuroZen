<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Round 1 Assessment | TOTAL/100 SCORING READY</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Brand Colors & Tailwind Config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-primary': '#3b82f6',
            'brand-secondary': '#06b6d4',
            'brand-accent': '#ec4899',
            'neutral-dark': '#0f172a',
            'neutral-light': '#f8fafc',
            'neutral-border': '#e2e8f0',
          },
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', 'sans-serif'],
            display: ['Plus Jakarta Sans', 'Inter', 'sans-serif'],
          },
          boxShadow: {
            'sm-light': '0 1px 2px 0 rgba(0, 0, 0, 0.05)',
            'md-light': '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03)',
            'lg-light': '0 10px 15px -3px rgba(0, 0, 0, 0.08)',
          },
          transitionProperty: {
            'width': 'width',
            'spacing': 'margin, padding',
            'colors': 'background-color, border-color, color, fill, stroke',
          },
        },
      },
    }
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet" />

  <style>
    * {
      font-family: 'Inter', ui-sans-serif;
    }

    body {
      background: #ffffff;
      overflow-x: hidden;
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #e0e7ff 0%, #f3f4f6 50%, #ede9fe 100%);
      z-index: -1;
      pointer-events: none;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse-smooth {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-8px); }
    }

    @keyframes glow-pulse {
      0%, 100% { box-shadow: 0 0 20px rgba(99,102,241,0.5); }
      50% { box-shadow: 0 0 40px rgba(99,102,241,0.8); }
    }

    .slide-in-up {
      animation: slideInUp 0.6s ease-out forwards;
    }

    .slide-in-down {
      animation: slideInDown 0.5s ease-out forwards;
    }

    #progressBar {
      animation: pulse-smooth 2s ease-in-out infinite;
    }

    .fade-in {
      animation: slideInUp 0.8s ease-out forwards;
      opacity: 0;
    }

    .float-animation {
      animation: float 3s ease-in-out infinite;
    }

    .glow-pulse {
      animation: glow-pulse 2s ease-in-out infinite;
    }

    .option-hover {
      position: relative;
      overflow: hidden;
    }

    .option-hover::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      animation: shimmer 3s infinite;
    }

    .progress-background {
      background: linear-gradient(90deg, rgba(99,102,241,0.1), rgba(124,58,237,0.1));
    }

    .glass-effect {
      background: #ffffff;
      backdrop-filter: blur(10px);
      border: 1px solid #e2e8f0;
    }

    .card-shadow {
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 2px 6px rgba(0, 0, 0, 0.04);
    }

    .smooth-transition {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Navigation Styles */
    .navbar {
      background: #ffffff;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid #e2e8f0;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }

    .nav-item {
      position: relative;
      padding: 0.6rem 1.1rem;
      border-radius: 0.65rem;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-weight: 500;
      font-size: 0.9rem;
      color: #64748b;
      cursor: pointer;
      white-space: nowrap;
    }

    .nav-item:hover {
      background-color: #f1f5f9;
      color: #3b82f6;
    }

    .nav-item.active {
      background-color: #eff6ff;
      color: #3b82f6;
      font-weight: 600;
    }

    .nav-item.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 1.1rem;
      right: 1.1rem;
      height: 2px;
      background: #3b82f6;
      border-radius: 1px;
    }

    .mobile-menu-toggle {
      display: none;
      width: 2rem;
      height: 2rem;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem;
      background-color: #f1f5f9;
      cursor: pointer;
      transition: all 0.25s ease;
      color: #64748b;
    }

    .mobile-menu-toggle:hover {
      background-color: #e2e8f0;
      color: #3b82f6;
    }

    @media (max-width: 768px) {
      .mobile-menu-toggle {
        display: flex;
      }

      .nav-menu {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #ffffff;
        backdrop-filter: blur(10px);
        border-bottom: 1px solid #e2e8f0;
        flex-direction: column;
        padding: 0.8rem;
        gap: 0.4rem;
        display: none;
      }

      .nav-menu.active {
        display: flex;
      }

      .nav-item {
        padding: 0.7rem 1rem;
        width: 100%;
        justify-content: flex-start;
      }

      .nav-item.active::after {
        display: none;
      }

      .nav-item.active {
        background: #eff6ff;
        color: #3b82f6;
      }
    }

    .user-avatar {
      width: 2.2rem;
      height: 2.2rem;
      border-radius: 50%;
      background: linear-gradient(135deg, #3b82f6, #06b6d4);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.25s ease;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
    }

    .user-avatar:hover {
      transform: scale(1.08);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25);
    }
  </style>
</head>

<body class="min-h-screen flex flex-col font-sans">
  <!-- Navigation Bar -->
  <nav class="navbar sticky top-0 z-50">
    <div class="max-w-7xl mx-auto w-full px-4 md:px-8 py-4 flex items-center justify-between">
      <!-- Logo -->
     <div class="flex items-center gap-2">
      <div class="w-9 h-9 bg-brand-primary text-white flex items-center justify-center rounded-lg font-bold">‚ô°</div>
      <span class="font-bold text-lg">MindCare</span>
    </div>

      <!-- Navigation Menu -->
      <div class="nav-menu flex items-center gap-2 md:gap-1">
        <a href="#dashboard" class="nav-item active" data-page="dashboard">
          <span>üìä</span>
          <span class="hidden md:inline">Dashboard</span>
        </a>
        <a href="#chat" class="nav-item" data-page="chat">
          <span>üí¨</span>
          <span class="hidden md:inline">Chat Assistant</span>
        </a>
        <a href="#doctor" class="nav-item" data-page="doctor">
          <span>üë®‚Äç‚öïÔ∏è</span>
          <span class="hidden md:inline">Doctor Consult</span>
        </a>
        <a href="#report" class="nav-item" data-page="report">
          <span>üìã</span>
          <span class="hidden md:inline">Report</span>
        </a>
        <a href="#profile" class="nav-item" data-page="profile">
          <span>üë§</span>
          <span class="hidden md:inline">Profile</span>
        </a>
      </div>

      <!-- Right Section: User & Logout -->
      <div class="flex items-center gap-4">
        
        <button class="nav-item" id="logoutBtn" onclick="handleLogout()">
          <span>üö™</span>
          <span class="hidden md:inline">Logout</span>
        </button>
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="flex-1 min-h-screen flex items-center justify-center p-6 md:p-8 font-sans">
  <div class="max-w-7xl w-full grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8 slide-in-up">

    <!-- Left: Assessment Form -->
    <div class="lg:col-span-2 glass-effect rounded-xl card-shadow border p-8 md:p-10">
      <!-- Header -->
      <div class="flex items-center justify-between mb-12 select-none">
        <div>
          <span id="stepText" class="text-xs font-semibold text-brand-primary uppercase tracking-wider block mb-1"></span>
          <span class="text-sm text-slate-500 font-medium">Mental Health Assessment</span>
        </div>
        <div class="w-32 h-2 bg-slate-200 rounded-full overflow-hidden">
          <div id="progressBar" class="h-2 bg-gradient-to-r from-brand-primary to-brand-secondary rounded-full transition-all duration-500 ease-out"></div>
        </div>
      </div>

      <!-- Question -->
      <h2 id="questionText" class="text-2xl md:text-3xl font-bold text-neutral-dark mb-10 leading-tight transition-all duration-500 font-display"></h2>

      <!-- Options -->
      <form id="questionForm" class="space-y-8">
        <div id="optionsContainer" class="space-y-6"></div>

        <!-- Navigation Buttons -->
        <div class="flex justify-between items-center mt-14 pt-8 border-t border-slate-200">
          <button type="button" id="backBtn" class="group text-slate-600 font-medium hover:text-brand-primary disabled:opacity-30 transition-all duration-250 px-5 py-2.5 rounded-lg select-none flex items-center gap-2 hover:bg-slate-100 disabled:cursor-not-allowed">
            <span class="text-lg leading-none transform group-hover:-translate-x-1 transition-transform duration-250">‚Üê</span> Back
          </button>
          <button type="submit" id="nextBtn" class="bg-brand-primary hover:bg-blue-600 active:bg-blue-700 text-white px-8 md:px-10 py-2.5 rounded-lg font-semibold transition-all duration-250 transform hover:shadow-md active:scale-95 select-none focus:ring-2 focus:ring-blue-500/50 disabled:opacity-50 disabled:cursor-not-allowed">
            Continue ‚Üí
          </button>
        </div>
      </form>
    </div>

    <!-- Right: Tips & Quotes -->
    <aside class="hidden lg:flex flex-col glass-effect rounded-xl card-shadow border p-8 sticky top-24 max-h-[75vh] overflow-y-auto">
      <!-- Quote -->
      <div class="mb-10 flex-grow flex flex-col justify-center items-center px-4 text-center py-6">
        <div class="mb-4">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-brand-primary/60 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M7.17 8A3.001 3.001 0 008 15h0a3 3 0 002.83-4H7.17zM4.5 12a4.5 4.5 0 014.5-4.5M19.5 12a4.5 4.5 0 00-4.5-4.5" />
          </svg>
        </div>
        <p id="healthQuote" class="text-base italic font-medium text-slate-700 leading-relaxed fade-in"></p>
      </div>

      <!-- Wellness Tips -->
      <div class="bg-blue-50 rounded-lg p-6 border border-blue-100">
        <div class="flex items-center gap-2 mb-5">
          <div class="h-1.5 w-6 bg-brand-primary rounded-full"></div>
          <h3 class="text-lg font-semibold text-slate-900">Quotes</h3>
          <span class="text-xs font-semibold text-emerald-700 bg-emerald-100 px-2.5 py-0.5 rounded-full">Round 1 of 2</span>
        </div>
        <ul class="space-y-3">
          <li class="flex items-start gap-3">
            <span class="text-lg flex-shrink-0">üì±</span>
            <span class="text-slate-700 font-medium text-sm">Healing isn‚Äôt linear ‚Äî progress comes in waves, and that‚Äôs okay.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-lg flex-shrink-0">‚ö°</span>
            <span class="text-slate-700 font-medium text-sm">Feelings are valid ‚Äî even when they‚Äôre hard to explain.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-lg flex-shrink-0">‚ûï</span>
            <span class="text-slate-700 font-medium text-sm">Asking for help is strength ‚Äî not weakness.</span>
          </li>
          <li class="flex items-start gap-3">
            <span class="text-lg flex-shrink-0">üéØ</span>
            <span class="text-slate-700 font-medium text-sm">Small steps matter ‚Äî consistency beats intensity.</span>
          </li>
        </ul>
      </div>

      <footer class="mt-auto text-center text-xs font-medium text-slate-500 mt-6 pt-5 border-t border-slate-200">
        Next: Round 2 Assessment
      </footer>
    </aside>
  </div>

  <script>
    // AUTH CHECK - REDIRECT IF NOT LOGGED IN
    if (!localStorage.getItem('mindwellToken')) {
      alert('Please login first');
      window.location.href = 'login.html';
    }

    /* ---------------- QUESTIONS ---------------- */
    const questions = [
      { id: 'q1', text: 'üõå How often do you wake up feeling low?', type: 'scale', labels: {1: 'Never', 5: 'Always'} },
      { id: 'q2', text: 'üò¥ Hours of sleep per night?', type: 'number', min: 0, max: 12 },
      { id: 'q3', text: 'üé® Lose interest in hobbies?', type: 'scale', labels: {1: 'Never', 5: 'Always'} },
      { id: 'q4', text: 'üìö Stay focused?', type: 'scale', labels: {1: 'Never', 5: 'Always'} },
      { id: 'q5', text: 'ü§ù Feel supported?', type: 'select', options: ['Yes, definitely', 'Somewhat', 'No, not really'] },
      { id: 'q6', text: '‚ö° Tasks overwhelming?', type: 'scale', labels: {1: 'Never', 5: 'Always'} },
      { id: 'q7', text: 'üçΩÔ∏è Appetite change?', type: 'select', options: ['Normal', 'Poor', 'Overeating'] },
      { id: 'q8', text: 'üîã Feel tired?', type: 'select', options: ['Rarely', 'Sometimes', 'Often', 'Constantly'] },
      { id: 'q9', text: 'üèÉ Weekly activity?', type: 'select', options: ['Daily', '3-4 times/week', '1-2 times/week', 'Rarely'] },
      { id: 'q10', text: 'üß† Mental health today?', type: 'scale', labels: {1: 'Very poor', 5: 'Excellent'} },
    ];

    /* ---------------- STATE ---------------- */
    let currentStep = 0;
    let answers = {};

    /* ---------------- DOM ---------------- */
    const questionText = document.getElementById("questionText");
    const optionsContainer = document.getElementById("optionsContainer");
    const stepText = document.getElementById("stepText");
    const progressBar = document.getElementById("progressBar");
    const backBtn = document.getElementById("backBtn");
    const form = document.getElementById("questionForm");
    const healthQuote = document.getElementById("healthQuote");
    const nextBtn = document.getElementById("nextBtn");

    /* ---------------- QUOTES ---------------- */
    const quotes = [
      "Your mental health matters just as much as your physical health.",
      "Healing is not linear ‚Äî be kind to yourself.",
      "Small steps every day lead to meaningful change.",
      "It's okay to slow down. You are not falling behind.",
      "Taking care of your mind is a form of strength."
    ];

    function showRandomQuote() {
      const randomIndex = Math.floor(Math.random() * quotes.length);
      healthQuote.innerText = `"${quotes[randomIndex]}"`;
      healthQuote.classList.remove("fade-in");
      void healthQuote.offsetWidth;
      healthQuote.classList.add("fade-in");
    }

    /* ---------------- RENDER ---------------- */
    function renderQuestion() {
      const q = questions[currentStep];
      stepText.innerText = `Question ${currentStep + 1} / ${questions.length}`;
      const progress = ((currentStep + 1) / questions.length) * 100;
      progressBar.style.width = progress + "%";

      questionText.classList.add("opacity-0");
      setTimeout(() => {
        questionText.innerText = q.text;
        questionText.classList.remove("opacity-0");
      }, 200);

      optionsContainer.innerHTML = "";
      backBtn.disabled = currentStep === 0;
      nextBtn.disabled = false;
      nextBtn.innerText = currentStep === questions.length - 1 ? "‚úÖ Finish Round 1" : "Continue ‚û°Ô∏è";

      // Scale (1-5)
      if (q.type === "scale") {
        for (let i = 1; i <= 5; i++) {
          const selected = answers[q.id] == i;
          optionsContainer.innerHTML += `
            <label class="option-hover group block border p-4 md:p-5 rounded-lg cursor-pointer transition-all duration-250 mb-3 ${selected ? 'bg-blue-500 text-white shadow-md border-blue-600' : 'bg-slate-50 border-slate-200 hover:border-blue-300 hover:bg-blue-50 hover:shadow-sm'}">
              <div class="flex items-center gap-4">
                <input type="radio" name="${q.id}" hidden value="${i}" ${selected ? 'checked' : ''} />
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-semibold text-sm flex-shrink-0 ${selected ? 'border-white bg-white/20' : 'border-slate-300 bg-white group-hover:border-blue-400'}">
                  ${selected ? '‚úì' : i}
                </div>
                <div class="flex-grow">
                  <span class="block font-semibold">${i}</span>
                  <span class="text-xs ${selected ? 'text-blue-100' : 'text-slate-600'}">${q.labels?.[i] || (i === 1 ? 'Never' : i === 5 ? 'Always' : '')}</span>
                </div>
              </div>
            </label>
          `;
        }
      }

      // Select options
      if (q.type === "select") {
        q.options.forEach((opt, idx) => {
          const selected = answers[q.id] === opt;
          optionsContainer.innerHTML += `
            <label class="option-hover group block border p-4 md:p-5 rounded-lg cursor-pointer transition-all duration-250 mb-3 ${selected ? 'bg-blue-500 text-white shadow-md border-blue-600' : 'bg-slate-50 border-slate-200 hover:border-blue-300 hover:bg-blue-50 hover:shadow-sm'}">
              <div class="flex items-center gap-4">
                <input type="radio" name="${q.id}" hidden value="${opt}" ${selected ? 'checked' : ''} />
                <div class="w-10 h-10 rounded-full border-2 flex items-center justify-center font-semibold text-sm flex-shrink-0 ${selected ? 'border-white bg-white/20' : 'border-slate-300 bg-white group-hover:border-blue-400'}">
                  ${selected ? '‚úì' : (idx + 1)}
                </div>
                <span class="font-semibold">${opt}</span>
              </div>
            </label>
          `;
        });
      }

      // Number input
      if (q.type === "number") {
        optionsContainer.innerHTML = `
          <div class="relative">
            <input type="number" min="${q.min}" max="${q.max}" required value="${answers[q.id] || ''}" id="numberInput" placeholder="Enter a value..." class="block w-full border border-slate-300 rounded-lg p-4 md:p-5 text-xl focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500 outline-none transition-all duration-250 hover:border-slate-400 font-semibold bg-white" />
          </div>
        `;
      }

      showRandomQuote();
    }

    /* ---------------- EVENTS ---------------- */
    // Option selection handler
    optionsContainer.addEventListener("click", e => {
      const label = e.target.closest("label");
      if (!label) return;
      const input = label.querySelector("input");
      if (!input) return;
      answers[questions[currentStep].id] = input.value;
      renderQuestion();
    });

    // Number input handler
    optionsContainer.addEventListener("input", e => {
      if (e.target.id === "numberInput") {
        answers[questions[currentStep].id] = e.target.value;
      }
    });

    // Back button
    backBtn.addEventListener("click", () => {
      if (currentStep > 0) {
        currentStep--;
        renderQuestion();
      }
    });

    // üî• FIXED SUBMIT - LOCALSTORAGE ONLY (NO BACKEND CALL!)
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      
      console.log('üîç ROUND1 ANSWERS:', answers);

      if (currentStep < questions.length - 1) {
        currentStep++;
        renderQuestion();
        return;
      }

      // ‚úÖ NO BACKEND CALL - JUST LOCALSTORAGE
      nextBtn.disabled = true;
      const originalHTML = nextBtn.innerHTML;
      nextBtn.innerHTML = '<span class="flex items-center gap-2"><span class="inline-block animate-spin">‚è≥</span> Saving...</span>';

      // Simulate save delay
      setTimeout(() => {
        // SAVE TO LOCALSTORAGE FOR ROUND2
        localStorage.setItem("round1Result", JSON.stringify({ 
          answers: answers
        }));
        console.log('üíæ ROUND1 SAVED TO LOCALSTORAGE (10 questions ready for TOTAL/100)');
        
        nextBtn.innerHTML = '<span class="flex items-center gap-2"><span>‚úì</span> Saved! Moving to Round 2...</span>';
        
        // SMOOTH REDIRECT TO ROUND2
        setTimeout(() => {
          window.location.href = "round2.html";
        }, 1000);
        
      }, 1200);

      nextBtn.disabled = false;
    });

    /* ---------------- INIT ---------------- */
    renderQuestion();

    // ==================== NAVIGATION FUNCTIONS ====================
    
    // Toggle mobile menu
    function toggleMobileMenu() {
      const navMenu = document.querySelector('.nav-menu');
      navMenu.classList.toggle('active');
    }

    // Handle navigation item clicks
    document.querySelectorAll('.nav-item[data-page]').forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();
        const page = this.getAttribute('data-page');
        handleNavigation(page);
      });
    });

    // Main navigation handler
    function handleNavigation(page) {
      // Remove active class from all nav items
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      
      // Add active class to clicked item
      document.querySelector(`[data-page="${page}"]`).classList.add('active');
      
      // Close mobile menu
      const navMenu = document.querySelector('.nav-menu');
      navMenu.classList.remove('active');

      // Navigate to page
      const pages = {
        'dashboard': '#dashboard',
        'chat': 'chat-assistant.html',
        'doctor': 'doctor-consult.html',
        'report': 'report.html',
        'profile': 'profile.html'
      };

      if (pages[page]) {
        // Save current state before leaving
        localStorage.setItem('currentPage', page);
        // Redirect to page
        window.location.href = pages[page];
      }
    }

    // Handle logout
    function handleLogout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('mindwellToken');
        localStorage.removeItem('round1Result');
        localStorage.removeItem('round2Result');
        localStorage.removeItem('currentPage');
        console.log('Logged out successfully');
        window.location.href = 'login.html';
      }
    }

    // Restore active nav item on page load
    function restoreNavState() {
      const currentPage = localStorage.getItem('currentPage') || 'dashboard';
      const navItem = document.querySelector(`[data-page="${currentPage}"]`);
      if (navItem) {
        navItem.classList.add('active');
      }
    }

    // Close mobile menu when clicking outside
    document.addEventListener('click', function(e) {
      const navbar = document.querySelector('.navbar');
      const navMenu = document.querySelector('.nav-menu');
      const toggleBtn = document.querySelector('.mobile-menu-toggle');
      
      if (!navbar.contains(e.target) && navMenu.classList.contains('active')) {
        navMenu.classList.remove('active');
      }
    });

    // Initialize navigation on page load
    restoreNavState();
  </script>
</body>
</html>
